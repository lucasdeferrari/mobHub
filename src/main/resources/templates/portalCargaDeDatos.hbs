{{#partial "contenido" }}
    <link rel="stylesheet" href="/css/portalCargaDeDatos.css">
    <!-- Contenido principal de tu página -->
    <title>Portal</title>
    <div class="container">
        <div class="upload-box">
            <h2>Portal de Carga de Datos</h2>
            <h5>Entidades prestadoras y organismos de control</h5>
            <form id="archivoForm" enctype="multipart/form-data">
                <div class="input-box">
                    <input type="file" id="archivo" accept=".csv" style="display: none;">
                    <label for="archivo" id="nombre-archivo">Archivo seleccionado: Ningún archivo seleccionado</label>
                    <button type="button" onclick="document.getElementById('archivo').click();">Seleccionar su archivo .csv</button>
                </div>
                <!-- Cambié el type de button a submit -->
                <input type="submit" class="subir-button" value="Subir archivo">
            </form>
        </div>
    </div>

    <!-- Scripts de Bootstrap y otros recursos -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        document.getElementById('archivo').addEventListener('change', function () {
            const inputFile = document.getElementById('archivo');
            const archivoSeleccionado = inputFile.files.length > 0 ? inputFile.files[0].name : 'Ningún archivo seleccionado';
            document.getElementById('nombre-archivo').innerText = `Archivo seleccionado: ${archivoSeleccionado}`;
        });

        document.getElementById('archivoForm').addEventListener('submit', function (event) {
            event.preventDefault(); // Evitar que el formulario se envíe normalmente
            subirArchivo();
        });

        function subirArchivo() {
            const inputFile = document.getElementById('archivo');
            if (inputFile.files.length > 0) {
                const archivo = inputFile.files[0];
                const formData = new FormData();
                formData.append('archivo', archivo);

                // Utilizando Axios para la solicitud AJAX
                axios.post('/portalCargaDeDatos', formData)
                        .then(response => {
                            if (response.status === 200) {
                                alert('El archivo se ha subido con éxito.');
                            } else {
                                alert('Hubo un error al subir el archivo.');
                            }
                        })
                        .catch(error => {
                            console.error('Error en la solicitud AJAX:', error);
                            alert('Hubo un error en la solicitud AJAX.');
                        });
            } else {
                alert('Por favor, seleccione un archivo primero.');
            }
        }
    </script>
{{/partial}}
{{> templates/base }}
